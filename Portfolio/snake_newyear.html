<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>New Year Snake</title>
    <style>
        body {
            /* –£–±–∏—Ä–∞–µ–º –≤—Å–µ –æ—Ç—Å—Ç—É–ø—ã, —á—Ç–æ–±—ã –∏–≥—Ä–∞ –∑–∞–Ω–∏–º–∞–ª–∞ 100% –æ–∫–Ω–∞ */
            margin: 0;
            padding: 0;
            overflow: hidden; /* –ó–∞–ø—Ä–µ—â–∞–µ–º —Å–∫—Ä–æ–ª–ª */
            background: linear-gradient(to bottom, #021b35, #123e66);
            font-family: 'Segoe UI', sans-serif;
        }

        #game-wrapper {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        canvas {
            display: block;
            /* –°–Ω–µ–∂–∏–Ω–∫–∏ –∏ –∑–º–µ–π–∫–∞ –±—É–¥—É—Ç –Ω–∞ —ç—Ç–æ–º —Ñ–æ–Ω–µ */
            background: transparent; 
        }

        /* --- –ò–ù–¢–ï–†–§–ï–ô–° –ü–û–í–ï–†–• –ò–ì–†–´ (HUD) --- */
        #ui-layer {
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            pointer-events: none; /* –ß—Ç–æ–±—ã –∫–ª–∏–∫–∏ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Å–∫–≤–æ–∑—å —Ç–µ–∫—Å—Ç */
            z-index: 10;
        }

        /* –°—Ç–∏–ª—å –≤–æ–ø—Ä–æ—Å–∞ - –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è –∫–∞–ø—Å—É–ª–∞ */
        #question-box {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 10px 25px;
            border-radius: 30px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        #question-label {
            display: block;
            color: #ccc;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 2px;
        }

        #question-text {
            color: #ffd700; /* –ó–æ–ª–æ—Ç–æ–π —Ç–µ–∫—Å—Ç */
            font-size: 20px;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        /* –°—á–µ—Ç –≤ —É–≥–ª—É */
        #score-badge {
            position: absolute;
            bottom: 15px;
            left: 15px;
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 15px;
            border-radius: 15px;
            color: #fff;
            font-weight: bold;
            font-size: 16px;
            pointer-events: none;
        }

        /* –≠–∫—Ä–∞–Ω –ø—Ä–æ–∏–≥—Ä—ã—à–∞ */
        #game-over {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 30px 50px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 0 40px rgba(0,0,0,0.5);
            z-index: 20;
            animation: popIn 0.3s ease;
        }

        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        button {
            background: #d60000;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 50px;
            margin-top: 15px;
            box-shadow: 0 4px 10px rgba(214, 0, 0, 0.4);
            transition: transform 0.2s;
        }
        button:hover { transform: scale(1.05); background: #ff1a1a; }

    </style>
</head>
<body>

    <div id="game-wrapper">
        
        <div id="ui-layer">
            <div id="question-box">
                <span id="question-label">–ù–∞–π–¥–∏ –ø—Ä–µ–¥–º–µ—Ç:</span>
                <span id="question-text">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
        </div>

        <div id="score-badge">üéÅ 0</div>

        <div id="game-over">
            <h2 style="margin:0 0 10px 0; color:#333;">–û–ô! –°–£–ì–†–û–ë! ‚ùÑÔ∏è</h2>
            <p id="final-score" style="margin:0; font-size: 18px; color:#555;">–°—á–µ—Ç: 0</p>
            <button onclick="startGame()">–ò–ì–†–ê–¢–¨ –°–ù–û–í–ê</button>
        </div>

        <canvas id="gameCanvas"></canvas>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const questionEl = document.getElementById('question-text');
    const scoreEl = document.getElementById('score-badge');
    const gameOverEl = document.getElementById('game-over');
    const finalScoreEl = document.getElementById('final-score');

    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä Canvas –ø–æ–¥ —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ iframe
    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    const box = 20; 
    let score = 0;
    let snowFlakes = [];
    const SNAKE_SPEED = 9;
    let lastRenderTime = 0;
    let gameOver = false;

    const questions = [
        { q: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –í–í–û–î–ê", right: "–ú–´–®–¨", wrong: "–≠–ö–†–ê–ù" },
        { q: "–ú–æ–∑–≥ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞", right: "CPU", wrong: "SSD" },
        { q: "–ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å–µ—Ç—å", right: "INET", wrong: "LAN" },
        { q: "–Ø–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏", right: "HTML", wrong: "CSS" },
        { q: "–í—Ä–µ–¥–æ–Ω–æ—Å", right: "–í–ò–†–£–°", wrong: "KASP" },
        { q: "–ì—Ä–∞—Ñ–∏–∫–∞", right: "GPU", wrong: "RAM" },
        { q: "–•—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª—ã", right: "HDD", wrong: "RAM" },
        { q: "–ó–≤—É–∫", right: "MP3", wrong: "JPEG" }
    ];

    let snake = [];
    let foods = []; 
    let currentQ = {};
    let direction;
    let nextDirection;

    // –°–Ω–µ–∂–∏–Ω–∫–∏
    for(let i=0; i<60; i++) {
        snowFlakes.push({
            x: Math.random() * window.innerWidth,
            y: Math.random() * window.innerHeight,
            r: Math.random() * 2 + 1,
            d: Math.random() + 0.5
        });
    }

    function main(currentTime) {
        if (gameOver) return;
        window.requestAnimationFrame(main);
        const secondsSinceLastRender = (currentTime - lastRenderTime) / 1000;
        if (secondsSinceLastRender < 1 / SNAKE_SPEED) return;
        lastRenderTime = currentTime;
        update();
        draw();
    }

    function drawSnow() {
        ctx.fillStyle = "rgba(255, 255, 255, 0.5)";
        ctx.beginPath();
        for(let i = 0; i < snowFlakes.length; i++) {
            let p = snowFlakes[i];
            ctx.moveTo(p.x, p.y);
            ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2, true);
        }
        ctx.fill();
        moveSnow();
    }

    function moveSnow() {
        for(let i = 0; i < snowFlakes.length; i++) {
            let p = snowFlakes[i];
            p.y += p.d;
            if(p.y > canvas.height) {
                p.y = 0;
                p.x = Math.random() * canvas.width;
            }
        }
    }

    function startGame() {
        resizeCanvas();
        snake = [];
        snake[0] = { x: 10 * box, y: 10 * box };
        direction = "RIGHT";
        nextDirection = "RIGHT";
        score = 0;
        scoreEl.innerHTML = "üéÅ " + score;
        gameOverEl.style.display = "none";
        gameOver = false;
        window.focus();
        newQuestion();
        window.requestAnimationFrame(main);
    }

    function newQuestion() {
        currentQ = questions[Math.floor(Math.random() * questions.length)];
        questionEl.innerText = currentQ.q;
        foods = [];
        spawnFood(currentQ.right, true);
        spawnFood(currentQ.wrong, false);
    }

    function spawnFood(text, isCorrect) {
        // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è, –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ –∫ –∫—Ä–∞—è–º (–æ—Ç—Å—Ç—É–ø 2 –∫–ª–µ—Ç–∫–∏)
        let maxX = Math.floor(canvas.width / box) - 2;
        let maxY = Math.floor(canvas.height / box) - 2;
        
        let food = {
            x: (Math.floor(Math.random() * maxX) + 1) * box,
            y: (Math.floor(Math.random() * maxY) + 1) * box,
            text: text,
            isCorrect: isCorrect
        };

        for(let i=0; i < snake.length; i++){
            if(food.x == snake[i].x && food.y == snake[i].y) return spawnFood(text, isCorrect);
        }
        foods.push(food);
    }

    document.addEventListener("keydown", directionControl);

    function directionControl(event) {
        let key = event.keyCode;
        if([37, 38, 39, 40].indexOf(key) > -1) event.preventDefault();
        if(key == 37 && direction != "RIGHT") nextDirection = "LEFT";
        else if(key == 38 && direction != "DOWN") nextDirection = "UP";
        else if(key == 39 && direction != "LEFT") nextDirection = "RIGHT";
        else if(key == 40 && direction != "UP") nextDirection = "DOWN";
    }

    function update() {
        direction = nextDirection;
        let snakeX = snake[0].x;
        let snakeY = snake[0].y;

        if(direction == "LEFT") snakeX -= box;
        if(direction == "UP") snakeY -= box;
        if(direction == "RIGHT") snakeX += box;
        if(direction == "DOWN") snakeY += box;

        let ateFood = false;
        for(let i=0; i < foods.length; i++) {
            // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–∏–∑–∏–∏ (—Ü–µ–Ω—Ç—Ä—ã –∫–ª–µ—Ç–æ–∫)
            let dist = Math.abs(snakeX - foods[i].x) + Math.abs(snakeY - foods[i].y);
            if(dist < box) {
                if(foods[i].isCorrect) {
                    score++;
                    scoreEl.innerHTML = "üéÅ " + score;
                    ateFood = true;
                    newQuestion();
                } else {
                    endGame();
                    return; 
                }
            }
        }

        if(!ateFood) snake.pop();

        let newHead = { x: snakeX, y: snakeY };

        if(snakeX < 0 || snakeX >= canvas.width || snakeY < 0 || snakeY >= canvas.height || collision(newHead, snake)) {
            endGame();
            return;
        }
        snake.unshift(newHead);
    }

    function draw() {
        ctx.clearRect(0,0, canvas.width, canvas.height);
        drawSnow(); 

        // –ó–º–µ–π–∫–∞
        for(let i = 0; i < snake.length; i++) {
            let colors = ["#00FF00", "#FF0000", "#FFD700"];
            ctx.fillStyle = (i == 0) ? "#FFF" : colors[i % 3];
            ctx.beginPath();
            // –î–µ–ª–∞–µ–º –∑–º–µ–π–∫—É –∫—Ä—É–≥–ª–æ–π –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã
            ctx.arc(snake[i].x + box/2, snake[i].y + box/2, box/2 - 1, 0, Math.PI*2);
            ctx.fill();
            // –õ–µ–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ
            ctx.shadowBlur = 10;
            ctx.shadowColor = colors[i % 3];
        }
        ctx.shadowBlur = 0;

        // –ï–¥–∞
        for(let i=0; i < foods.length; i++) {
            let f = foods[i];
            let icon = f.isCorrect ? "üéÅ" : "‚ùÑÔ∏è"; 
            
            ctx.font = "22px Arial";
            ctx.fillText(icon, f.x - 2, f.y + 18);

            ctx.fillStyle = "#FFF";
            ctx.font = "bold 13px Segoe UI";
            ctx.fillText(f.text, f.x - 5, f.y - 5);
        }
    }

    function collision(head, array) {
        for(let i = 0; i < array.length; i++) {
            if(head.x == array[i].x && head.y == array[i].y) return true;
        }
        return false;
    }

    function endGame() {
        gameOver = true;
        finalScoreEl.innerText = "–°–æ–±—Ä–∞–Ω–æ –ø–æ–¥–∞—Ä–∫–æ–≤: " + score;
        gameOverEl.style.display = "block";
    }
    
    canvas.addEventListener('click', function() { window.focus(); });
    startGame();
</script>
</body>
</html>